# NASBox Samba Configuration
# SMB/CIFS File Sharing

[global]
    workgroup = NASBOX
    server string = NASBox File Server
    netbios name = NASBOX
    
    # Security
    security = user
    map to guest = Bad User
    guest account = nobody
    
    # Performance optimizations for NAS
    socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=524288 SO_SNDBUF=524288
    read raw = yes
    write raw = yes
    max xmit = 65535
    dead time = 15
    getwd cache = yes
    
    # SMB protocol versions
    server min protocol = SMB2
    server max protocol = SMB3
    
    # Logging
    log file = /var/log/samba/log.%m
    max log size = 1000
    log level = 1
    
    # Enable ACL support
    vfs objects = acl_xattr
    map acl inherit = yes
    store dos attributes = yes
    
    # macOS compatibility
    fruit:aapl = yes
    fruit:nfs_aces = no
    fruit:model = MacSamba

# Public share (guest accessible)
[public]
    path = /mnt/storage/public
    browseable = yes
    read only = no
    guest ok = yes
    create mask = 0664
    directory mask = 0775
    force user = nobody
    force group = nogroup

# User homes
[homes]
    comment = Home Directories
    browseable = no
    read only = no
    create mask = 0700
    directory mask = 0700
    valid users = %S

# Media share
[media]
    path = /mnt/storage/media
    comment = Media Files
    browseable = yes
    read only = yes
    guest ok = yes
    
# Documents share (authenticated)
[documents]
    path = /mnt/storage/documents
    comment = Documents
    browseable = yes
    read only = no
    valid users = @users
    create mask = 0660
    directory mask = 0770
    force group = users

# Backups share
[backups]
    path = /mnt/storage/backups
    comment = Backup Storage
    browseable = yes
    read only = no
    valid users = @admin
    create mask = 0660
    directory mask = 0770

# Time Machine backup for macOS
[timemachine]
    path = /mnt/storage/timemachine
    comment = Time Machine Backup
    browseable = yes
    read only = no
    fruit:time machine = yes
    fruit:time machine max size = 500G
    valid users = @users
